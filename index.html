<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>청주 이사 최종 보고서</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f0f4f8; }
        .section-card {
            background-color: white; border-radius: 0.75rem; box-shadow: 0 4px 12px rgba(0,0,0,0.08); padding: 2rem; margin-bottom: 2.5rem;
        }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin: 1.5rem auto; height: 350px; }
        .expert-decision-card {
            background-color: #e6f2ff; border-left: 4px solid #0056b3; padding: 1.5rem; border-radius: 0.5rem;
        }
        .apartment-card {
            background-color: white; border-radius: 0.75rem; box-shadow: 0 2px 8px rgba(0,0-0,0.05); padding: 1.5rem;
        }
        .text-blue-dark { color: #003366; }
        @media (max-width: 768px) {
            .section-card { padding: 1rem; }
            .chart-container { height: 250px; }
            .apartment-card { padding: 1rem; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <header class="bg-white/90 backdrop-blur-lg shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <h1 class="text-2xl md:text-3xl font-bold text-center text-blue-dark">청주 아파트 최종 이사 컨설팅</h1>
            <p class="text-center text-gray-500 mt-1">전문가 분석을 통한 최적의 선택</p>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8 mt-6">
        <section id="expert-decision" class="section-card expert-decision-card">
            <h2 class="text-2xl font-bold mb-4 text-blue-dark">전문가 최종 결정안</h2>
            <p class="text-gray-700 leading-relaxed text-lg">
                가장 높은 순위의 아이파크 1단지와 비교해 가격은 2천만 원가량 낮으면서, 신축의 쾌적함과 더불어 아이파크 1단지와 동일한 생활권과 학군 인프라를 공유합니다. 무엇보다 고객님의 가용 예산(다자녀 특별 대출 활용 시)에 안정적으로 진입할 수 있는 최적의 아파트입니다.
            </p>
            <p class="text-gray-700 mt-2 text-lg font-bold">
                최종 추천: 가경동 아이파크 2단지
            </p>
            <div class="mt-4 text-center">
                 <a href="https://land.naver.com/complex/111832.html" target="_blank" class="inline-block bg-blue-600 text-white font-bold py-2 px-6 rounded-full hover:bg-blue-700 transition-colors">네이버 부동산 바로가기</a>
            </div>
        </section>
        
        <section id="budget-summary" class="section-card">
            <h2 class="text-2xl font-bold mb-4 text-center text-blue-dark">고객님 최종 가용 예산 분석</h2>
            <p class="text-center text-gray-600 mb-6">다자녀 혜택을 포함하여 계산한 고객님의 최대 가용 예산과 추천 아파트의 가격대를 비교해드립니다.</p>
            <div class="chart-container">
                <canvas id="budgetChart"></canvas>
            </div>
        </section>

        <section id="top-apartments" class="section-card">
            <h2 class="text-2xl font-bold mb-4 text-center text-blue-dark">청주 아파트 TOP 7 심층 비교 분석</h2>
            <p class="text-center text-gray-600 mb-6">학군, 미래가치, 환경, 가격을 종합적으로 평가한 순위입니다. 상세 내용을 확인해보세요.</p>
            <div id="apartment-list" class="space-y-8">
            </div>
        </section>
    </main>
    <footer class="text-center py-6 mt-8 bg-blue-dark text-white">
        <p>본 리포트는 투자를 위한 참고 자료이며, 현장 답사를 통해 최종 결정을 내리시길 권장합니다.</p>
    </footer>

    <script>
    const apartments = [
        { id: 1, name: '가경동 아이파크 1단지', price: '5.8억 ~ 6.2억', naverLink: 'https://land.naver.com/complex/21633.html', kbPriceSqM: '약 6.1억원 (84㎡)', rank: 1, scores: {'학군': 5, '미래가치': 4.5, '환경': 4.5, '가격': 2.5}, summary: '청주 최고의 학군과 인프라를 자랑하는 대장 아파트. 경덕초, 경덕중 배정 가능성이 높아 교육열 높은 부모님들께 최적. 다소 높은 가격대가 부담이지만, 그만큼의 가치 상승 여력이 충분합니다.', priceDetail: 6.0, requiredLoan15: 1.95, requiredLoan30: 0.95 },
        { id: 2, name: '가경동 아이파크 2단지', price: '5.6억 ~ 5.9억', naverLink: 'https://land.naver.com/complex/111832.html', kbPriceSqM: '약 5.9억원 (84㎡)', rank: 2, scores: {'학군': 4.5, '미래가치': 4.5, '환경': 5, '가격': 3}, summary: '1단지와 함께 가경동의 프리미엄을 이끄는 신축 단지. 공원, 상권이 잘 조성되어 쾌적한 환경을 자랑합니다. 1단지와 동일 생활권을 공유하며, 가격은 소폭 낮아 합리적인 선택이 될 수 있습니다.', priceDetail: 5.8, requiredLoan15: 1.75, requiredLoan30: 0.75 },
        { id: 3, name: '산남동 계룡 리슈빌', price: '4.6억 ~ 4.9억', naverLink: 'https://land.naver.com/complex/6122.html', kbPriceSqM: '약 4.8억원 (84㎡)', rank: 3, scores: {'학군': 5, '미래가치': 3, '환경': 3.5, '가격': 4}, summary: '청주의 전통적인 교육 중심지. 법조타운 주변의 면학 분위기와 풍부한 학원가가 압도적인 장점입니다. 다만 2007년식으로 신축 대비 주거 환경은 아쉽지만, 학군을 최우선으로 한다면 놓칠 수 없는 선택입니다.', priceDetail: 4.8, requiredLoan15: 0.75, requiredLoan30: 0 },
        { id: 4, name: '동남지구 우미린 에듀포레', price: '4.8억 ~ 5.1억', naverLink: 'https://land.naver.com/complex/120614.html', kbPriceSqM: '약 5.1억원 (84㎡)', rank: 4, scores: {'학군': 4.5, '미래가치': 4, '환경': 4.5, '가격': 4}, summary: '동남지구의 우수한 입지에 위치하며, 초등학교와 중학교가 도보권에 있어 자녀 교육에 매우 유리합니다. 계획도시의 쾌적한 환경과 합리적인 가격이 장점입니다.', priceDetail: 5.0, requiredLoan15: 0.95, requiredLoan30: 0 },
        { id: 5, name: '청주 테크노폴리스 푸르지오', price: '4.8억 ~ 5.2억', naverLink: 'https://land.naver.com/complex/145800.html', kbPriceSqM: '약 5.0억원 (84㎡)', rank: 5, scores: {'학군': 3, '미래가치': 5, '환경': 4, '가격': 4}, summary: '청주 미래가치의 핵심인 테크노폴리스 내 신축 단지. SK하이닉스 등 대기업의 배후 주거지로 높은 미래 가치가 기대됩니다. 아직은 학원가 등 교육 인프라가 미흡하지만, 향후 지속적으로 발전할 것입니다.', priceDetail: 5.0, requiredLoan15: 0.95, requiredLoan30: 0 },
        { id: 6, name: '가경동 가로수마을 e편한세상', price: '4.9억 ~ 5.2억', naverLink: 'https://land.naver.com/complex/16844.html', kbPriceSqM: '약 5.0억원 (84㎡)', rank: 6, scores: {'학군': 4.5, '미래가치': 3.5, '환경': 4, '가격': 3}, summary: '가경동 아이파크와 학군 및 생활권을 공유하며 편리한 교통과 풍부한 상권을 갖춘 준신축 아파트. 실거주 만족도가 높고 안정적인 시세를 유지하고 있습니다.', priceDetail: 5.0, requiredLoan15: 0.95, requiredLoan30: 0 },
        { id: 7, name: '동남지구 대원 더테라스 1단지', price: '5.0억 ~ 5.3억', naverLink: 'https://land.naver.com/complex/118318.html', kbPriceSqM: '약 5.2억원 (84㎡)', rank: 7, scores: {'학군': 4, '미래가치': 4, '환경': 5, '가격': 3}, summary: '테라스 특화 설계로 실거주 만족도가 높고, 넓은 공원이 인접해 쾌적한 환경을 제공합니다. 다만, 중학교가 다소 멀고 가격대가 높아 순위는 약간 뒤처졌지만, 충분히 고려할만한 가치가 있습니다.', priceDetail: 5.1, requiredLoan15: 1.05, requiredLoan30: 0.05 },
        { id: 8, name: '오송 서한이다음', price: '4.2억 ~ 4.5억', naverLink: 'https://land.naver.com/complex/131495.html', kbPriceSqM: '약 4.3억원 (84㎡)', rank: 8, scores: {'학군': 2.5, '미래가치': 4.5, '환경': 3, '가격': 5}, summary: '오송은 KTX 역세권과 바이오 산업의 미래가치로 주목받는 지역입니다. 가격이 매우 합리적이지만, 청주 도심과의 접근성이 떨어지고 아직 교육 인프라가 충분히 갖춰지지 않은 점은 고려해야 합니다.', priceDetail: 4.3, requiredLoan15: 0, requiredLoan30: 0},
    ];

    const budgetData = {
        labels: ['최종 가용 예산(15년)', '최종 가용 예산(30년)', '아이파크 1단지', '우미린 에듀포레', '테크노폴리스 푸르지오'],
        datasets: [{
            label: '금액 (억 원)', data: [4.25, 5.05, 6.0, 5.0, 5.0],
            backgroundColor: ['rgba(0, 51, 102, 0.8)', 'rgba(0, 119, 187, 0.8)', 'rgba(196, 126, 44, 0.8)', 'rgba(196, 126, 44, 0.8)', 'rgba(196, 126, 44, 0.8)'],
            borderColor: ['rgb(0, 51, 102)', 'rgb(0, 119, 187)', 'rgb(196, 126, 44)', 'rgb(196, 126, 44)', 'rgb(196, 126, 44)'], borderWidth: 1
        }]
    };

    function calculateLoanPayment(principal, annualRate, years) {
        if (principal <= 0 || years <= 0) return { monthlyPayments: [], totalInterest: 0 };
        const monthlyRate = annualRate / 12;
        const totalMonths = years * 12;
        let payments = [];
        let remainingPrincipal = principal;
        let totalInterest = 0;
        const pMonthly = principal / totalMonths;
        for (let i = 0; i < totalMonths; i++) {
            const interestPayment = remainingPrincipal * monthlyRate;
            const principalPayment = pMonthly;
            const totalPayment = principalPayment + interestPayment;
            remainingPrincipal -= principalPayment;
            totalInterest += interestPayment;
            payments.push({ month: i + 1, total: totalPayment });
        }
        return { payments: payments, totalInterest: totalInterest };
    }

    function renderBudgetChart() {
        const ctx = document.getElementById('budgetChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar', data: budgetData,
            options: {
                responsive: true, maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: '금액 (억 원)' } },
                    x: { ticks: { callback: (value, index) => budgetData.labels[index].split(' ') } }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: { callbacks: { label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y}억 원` } }
                }
            }
        });
    }

    function renderApartmentDetails() {
        const listContainer = document.getElementById('apartment-list');
        apartments.sort((a, b) => a.rank - b.rank).forEach(apt => {
            const loan15 = calculateLoanPayment(apt.requiredLoan15 * 100000000, 0.04, 15);
            const loan30 = calculateLoanPayment(apt.requiredLoan30 * 100000000, 0.04, 30);
            
            const aptHTML = `
                <div class="apartment-card grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <h3 class="text-xl font-bold mb-2 text-blue-dark">#${apt.rank}. ${apt.name}</h3>
                        <a href="${apt.naverLink}" target="_blank" class="text-blue-500 hover:underline text-sm mb-4 block">네이버 부동산 매물 확인하기 →</a>
                        <p class="text-gray-600 mb-4">${apt.summary}</p>
                        
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <p class="font-bold text-gray-700">전문가 평점</p>
                            <div class="grid grid-cols-2 gap-4 mt-2 text-sm">
                                <div class="flex items-center"><span class="w-20 font-semibold">학군</span><span>${'★'.repeat(Math.round(apt.scores['학군']))}${'☆'.repeat(5 - Math.round(apt.scores['학군']))}</span></div>
                                <div class="flex items-center"><span class="w-20 font-semibold">미래가치</span><span>${'★'.repeat(Math.round(apt.scores['미래가치']))}${'☆'.repeat(5 - Math.round(apt.scores['미래가치']))}</span></div>
                                <div class="flex items-center"><span class="w-20 font-semibold">환경</span><span>${'★'.repeat(Math.round(apt.scores['환경']))}${'☆'.repeat(5 - Math.round(apt.scores['환경']))}</span></div>
                                <div class="flex items-center"><span class="w-20 font-semibold">가격</span><span>${'★'.repeat(Math.round(apt.scores['가격']))}${'☆'.repeat(5 - Math.round(apt.scores['가격']))}</span></div>
                            </div>
                        </div>

                        <div class="bg-gray-50 p-4 rounded-lg mt-4">
                            <p class="font-bold text-gray-700">예상 매매 금액 및 대출 시뮬레이션</p>
                            <div class="mt-2 text-sm">
                                <div class="flex justify-between py-1"><span>예상 매매가</span><span class="font-bold">${apt.priceDetail}억 원</span></div>
                                <div class="flex justify-between py-1"><span>KB 시세 (84㎡)</span><span class="font-bold">${apt.kbPriceSqM}</span></div>
                                <div class="flex justify-between py-1"><span>필요 대출금(15년)</span><span class="font-bold text-red-600">${apt.requiredLoan15.toFixed(2)}억 원</span></div>
                                <div class="flex justify-between py-1"><span>필요 대출금(30년)</span><span class="font-bold text-blue-600">${apt.requiredLoan30.toFixed(2)}억 원</span></div>
                            </div>
                            <div class="mt-4 border-t pt-2 border-gray-200">
                                ${apt.requiredLoan15 > 0 ? `
                                <p class="font-bold text-sm text-red-600">■ 15년 상환 (원금균등)</p>
                                <p class="text-xs text-gray-500">대출원금 ${apt.requiredLoan15}억 / 연 4% 금리 가정</p>
                                <div class="flex justify-between items-center text-sm mt-1"><span class="font-semibold text-gray-700">1회차 상환액</span><span class="font-bold">${ (loan15.payments[0].total / 10000).toFixed(0) }만 원</span></div>
                                <div class="flex justify-between items-center text-sm mt-1"><span class="font-semibold text-gray-700">총 이자액</span><span class="font-bold">${ (loan15.totalInterest / 10000).toFixed(0) }만 원</span></div>
                                ` : ''}
                                ${apt.requiredLoan30 > 0 ? `
                                <p class="font-bold text-sm text-blue-600 mt-4">■ 30년 상환 (다자녀 우대, 원금균등)</p>
                                <p class="text-xs text-gray-500">대출원금 ${apt.requiredLoan30}억 / 연 4% 금리 가정</p>
                                <div class="flex justify-between items-center text-sm mt-1"><span class="font-semibold text-gray-700">1회차 상환액</span><span class="font-bold">${ (loan30.payments[0].total / 10000).toFixed(0) }만 원</span></div>
                                <div class="flex justify-between items-center text-sm mt-1"><span class="font-semibold text-gray-700">총 이자액</span><span class="font-bold">${ (loan30.totalInterest / 10000).toFixed(0) }만 원</span></div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="radarChart-${apt.id}"></canvas>
                    </div>
                </div>
            `;
            listContainer.innerHTML += aptHTML;
        });

        apartments.forEach(apt => {
            renderRadarChart(apt.id, apt.scores);
        });
    }

    function renderRadarChart(id, scores) {
        const ctx = document.getElementById(`radarChart-${id}`).getContext('2d');
        new Chart(ctx, {
            type: 'radar', data: {
                labels: Object.keys(scores),
                datasets: [{
                    label: '평가', data: Object.values(scores), fill: true,
                    backgroundColor: 'rgba(0, 119, 187, 0.2)', borderColor: 'rgb(0, 119, 187)',
                    pointBackgroundColor: 'rgb(0, 119, 187)', pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff', pointHoverBorderColor: 'rgb(0, 119, 187)'
                }]
            },
            options: {
                maintainAspectRatio: false, scales: {
                    r: {
                        angleLines: { color: 'rgba(0, 0, 0, 0.1)' }, grid: { color: 'rgba(0, 0, 0, 0.1)' },
                        pointLabels: { font: { size: 14 } }, min: 0, max: 5, ticks: { stepSize: 1, backdropColor: 'rgba(255, 255, 255, 0.75)' }
                    }
                }, plugins: { legend: { display: false } }
            }
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
        renderBudgetChart();
        renderApartmentDetails();
    });
    </script>
</body>
</html>
